<!DOCTYPE HTML>
<html>
	<head>
		<title>Jarvis</title>
		<link rel="stylesheet" href="http://s3.amazonaws.com/codecademy-content/courses/ltp/css/bootstrap.css">
		<link rel="stylesheet" href="driver.css">
		<script type="text/javascript"
      		src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCP8TOYl0iDUhmHKAcSIyzntxdgZkD5HDI">
	    </script>
    	<script type="text/javascript">
    		var sanFrancisco = new google.maps.LatLng(37.7833, -122.4167);
    		var directionsDisplayOne;
    		var directionsDisplayTwo;
			var directionsService = new google.maps.DirectionsService();
			var map;
    		var markers = [];
      		function initialize() {
      			directionsDisplayOne = new google.maps.DirectionsRenderer();
      			directionsDisplayTwo = new google.maps.DirectionsRenderer();
	        	var mapOptions = {
	          		center: sanFrancisco,
	          		zoom: 13,
	          		disableDefaultUI: true
	        	};
	        	map = new google.maps.Map(document.getElementById("map-canvas"), mapOptions);
	        	directionsDisplayOne.setMap(map);
	        	directionsDisplayTwo.setMap(map);
	        	google.maps.event.addListener(map, 'click', function(e) {
    				placeMarker(e.latLng, map);
  				});
      		}
      		google.maps.event.addDomListener(window, 'load', initialize);
  			function placeMarker(position, map) {
  				if (markers.length < 4) {
  					console.log("Placing Marker");
	  				var marker = new google.maps.Marker({
	    				position: position,
	    				draggable: true,
	    				map: map
	  				});
	  				map.panTo(position);
	  				markers.push(marker);
  				};
  				if (markers.length == 2) {
  					calcRoute(markers[0].position, markers[1].position, directionsDisplayOne);
  					markers[0].setMap(null);
  					markers[1].setMap(null);
  				};
  				if (markers.length == 4) {
  					calcRoute(markers[2].position, markers[3].position, directionsDisplayTwo);
  					markers[2].setMap(null);
  					markers[3].setMap(null);
  				};
			}
			function calcRoute(start, end, dd) {
  				var request = {
      				origin:start,
      				destination:end,
      				travelMode: google.maps.TravelMode.DRIVING
  				};
  				directionsService.route(request, function(response, status) {
    				if (status == google.maps.DirectionsStatus.OK) {
      					dd.setDirections(response);
    				}
  				});
			}
	    </script>
	</head>
	<body>
		<div class="nav nav-pills">
	    	<div class="container">
	        	<ul class="pull-left">
		  			<li><a href="../index.html">Peter Reveles</a></li>
		  			<li class="active"><a style="color: rgb(214, 56, 174);" href="forLyft/driver.html">For Lyft</a></li>
				</ul>
				<ul class="pull-right">
		    		<li><a href="https://twitter.com/PeterRevel">Twitter</a></li>
		    		<li><a href="https://github.com/peterrevel">Github</a></li>
		    		<li><a href="http://lnkd.in/GdTTPE">LinkedIn</a></li>
				</ul>
	    	</div>
	  	</div>
		<div class="jumbotron">
			<h1>Hello Driver, I'm Jarvis.</h1>
			<p>Touch the map to drop locations.</p>
		</div>
		<div id="map-canvas" />
	</body>
</html>